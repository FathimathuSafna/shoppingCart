<!-- HTML Table -->
<section>
    <div class="container">
        <div class="row mt-4">
            <table class="table mt-5">
                <thead>
                    <tr>
                        <th scope="col">Date</th>
                        <th>Address</th>   
                        <th>Pincode</th>                                                                    
                        <th>Mobile</th>
                        <th scope="col">Amount</th>
                        <th scope="col">Payment</th>
                        <th>Status</th>
                        <th>Action</th> <!-- Added Action column for button -->
                    </tr>
                </thead>
                <tbody>
                    {{#each orders}}
                    <tr>
                        <td>{{this.date}}</td>
                        <td>{{this.deliveryDetails.address}}</td>
                        <td>{{this.deliveryDetails.pincode}}</td>
                        <td>{{this.deliveryDetails.mobile}}</td>
                        <td>{{this.totalAmount}}</td>
                        <td>{{this.paymentMethod}}</td>
                        <td>{{this.status}}</td>
                        <td>
                            <button class="btn btn-sm btn-success" onClick="deliveredOrder('{{this._id}}')">Progress Order</button> <!-- Changed to order ID -->
                          
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </div>
</section>

<!-- JavaScript Function -->
<script>
   function deliveredOrder(orderId) {
    alert('Button clicked!')
    $.ajax({
        url: '/admin/delivered',
        data: { orderId: orderId },  // Make sure this key matches what the backend expects
        method: 'post',
        success: (response) => {
            console.log('Response from server:', response);  // Log the response to see what the server returns
            if (response.deliveredOrder) {
                alert('Order delivered');
                location.reload();
            } else {
                alert('Failed to place order.');
            }
        },
        error: (err) => {
            console.error('Error placing order:', err);
            alert('Something went wrong!');
        }
    });
}

</script>
